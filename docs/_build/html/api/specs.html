

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Specifying parameters &mdash; PtychoDactyl  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Camera interfacing" href="camera.html" />
    <link rel="prev" title="API Reference" href="api.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> PtychoDactyl
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../usage/installation.html">Installation &amp; Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/quickstart.html">Using PtychoDactyl</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Specifying parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="camera.html">Camera interfacing</a></li>
<li class="toctree-l2"><a class="reference internal" href="stages.html">Stage controller interfacing</a></li>
<li class="toctree-l2"><a class="reference internal" href="ptycho_data.html">Data management</a></li>
<li class="toctree-l2"><a class="reference internal" href="recon.html">Reconstruction</a></li>
<li class="toctree-l2"><a class="reference internal" href="scan.html">Scan parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utilities</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PtychoDactyl</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="api.html">API Reference</a> &raquo;</li>
        
      <li>Specifying parameters</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/api/specs.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="specifying-parameters">
<span id="specs"></span><h1>Specifying parameters<a class="headerlink" href="#specifying-parameters" title="Permalink to this headline">¶</a></h1>
<p>Process parameters are stored in designated objects in order to minimize the number of arguments passed to high-level functions.</p>
<dl class="py class">
<dt class="sig sig-object py" id="ptycho.specs_classes.CollectionSpecs">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ptycho.specs_classes.</span></span><span class="sig-name descname"><span class="pre">CollectionSpecs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stages</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">camera</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_pattern</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spiral'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rotations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames_per_take</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exposure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.97</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptycho.specs_classes.CollectionSpecs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="ptycho.specs_classes.CollectionSpecs.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stages</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">camera</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_pattern</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spiral'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rotations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames_per_take</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exposure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.97</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptycho.specs_classes.CollectionSpecs.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to specify parameters for ptychographic data collection. All distances should be given in millimeters
unless otherwise specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<em>str</em>) – Give your data run a name! The collected data will automatically be saved with this title as well
as the date on which it was completed, e.g. ‘pterodactylus-15-12-1784.pty’.</p></li>
<li><p><strong>stages</strong> (<em>str</em>) – Keyword for the stage controller you’re using. This should be all lowercase, and must match a
keyword from the dictionary defined in <code class="docutils literal notranslate"><span class="pre">stages.get_stages()</span></code>.</p></li>
<li><p><strong>camera</strong> (<em>str</em>) – Keyword for the camera you’re using. This should be all lowercase and must match a keyword from
the dictionary defined in <code class="docutils literal notranslate"><span class="pre">camera.get_camera()</span></code>.</p></li>
<li><p><strong>data_dir</strong> (<em>str</em>) – The directory where your data will be saved. If no value is given, it will automatically be
saved in <code class="docutils literal notranslate"><span class="pre">ptychodactyl/data</span></code>.</p></li>
<li><p><strong>scan_center</strong> (<em>float</em><em>, </em><em>float</em>) – The x- and y-position of the center of your ptychography scan, in the center-origin laser
reference frame.</p></li>
<li><p><strong>scan_width</strong> (<em>float</em>) – Full horizontal scanning range.</p></li>
<li><p><strong>scan_height</strong> (<em>float</em>) – Full vertical scanning range.</p></li>
<li><p><strong>scan_step</strong> (<em>float</em>) – Spacing between probe positions. This will affect the overlap, and should not be larger than
about 30% of the probe size.</p></li>
<li><p><strong>z_position</strong> (<em>float</em>) – Position of the sample along the optical axis.</p></li>
<li><p><strong>scan_pattern</strong> (<em>str</em>) – Geometric pattern for the ptychography scan. Options are <em>rect</em> (rectangular grid), <em>hex</em>
(hexagonal grid, tighter packed), and <em>spiral</em> (spiraling out from the center).</p></li>
<li><p><strong>num_rotations</strong> (<em>int</em>) – Number of rotational steps. If no value is given, the dataset will be 2D.</p></li>
<li><p><strong>background</strong> (<em>bool</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), the script will record a background image at the beginning of the
collection run. Otherwise, it’ll jump straight into the scan.</p></li>
<li><p><strong>frames_per_take</strong> (<em>int</em>) – For each scan position (and the background), the camera will take this many frames and
return their sum.</p></li>
<li><p><strong>resolution</strong> (<em>int</em>) – The side length (in pixels) of the desired image arrays. Larger images will be reduced
through a combination of binning and cropping.</p></li>
<li><p><strong>exposure</strong> (<em>int</em>) – Exposure time for each frame, in milliseconds.</p></li>
<li><p><strong>gain</strong> (<em>float</em>) – Analog gain applied to the camera to boost signal. Tends to increase noise; use with caution.</p></li>
<li><p><strong>distance</strong> (<em>float</em>) – Distance from the sample (or lens) to the image sensor, in METERS.</p></li>
<li><p><strong>energy</strong> (<em>float</em>) – Laser photon energy, in eV.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, print verbose information during the data collection. Otherwise, show a simple
progress bar.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptycho.specs_classes.ReconstructionSpecs">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ptycho.specs_classes.</span></span><span class="sig-name descname"><span class="pre">ReconstructionSpecs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate_positions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_subtract</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbleed_correct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0002</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptycho.specs_classes.ReconstructionSpecs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="ptycho.specs_classes.ReconstructionSpecs.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate_positions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_subtract</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbleed_correct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0002</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptycho.specs_classes.ReconstructionSpecs.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<em>str</em>) – The name of the PTY data file to reconstruct. (Works with or without the <code class="docutils literal notranslate"><span class="pre">.pty</span></code> suffix).</p></li>
<li><p><strong>data_dir</strong> (<em>str</em>) – The directory where your data file is located. If no value is given, it will automatically
load from <code class="docutils literal notranslate"><span class="pre">ptychodactyl/data</span></code>.</p></li>
<li><p><strong>flip_images</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, all diffraction images will be reflected vertically. Whether this is needed
depends on the behavior and position of the camera.</p></li>
<li><p><strong>rotate_positions</strong> (<em>float</em>) – Rotates all probe position coordinates by the given angle about the optical axis. Use
only if the camera’s image detector is rotated with respect to the stage coordinate system.</p></li>
<li><p><strong>background_subtract</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the reconstruction will subtract the stored background image from all
diffraction patterns.</p></li>
<li><p><strong>vbleed_correct</strong> (<em>float</em>) – Reduces vertical pixel bleeding on diffraction images. Essentially it subtracts a certain
quantile from each column. Must be between 0 and 1. Recommended starting value is 0.35.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Pixel values below this fraction of the maximum will be set to zero. Must be between 0 and 1.
Recommended starting value is 0.0001.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptycho.specs_classes.ReconstructionSpecs.add_cycle">
<span class="sig-name descname"><span class="pre">add_cycle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iterations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_update</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.9,</span> <span class="pre">0.9)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probe_update</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">animate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptycho.specs_classes.ReconstructionSpecs.add_cycle" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>algorithm</strong> (<em>str</em>) – The iterative algorithm to use for reconstruction. Currently the only options are ‘epie’ and
‘rpie’.</p></li>
<li><p><strong>num_iterations</strong> (<em>int</em>) – The number of iterations to run that particular algorithm.</p></li>
<li><p><strong>object_update</strong> (<em>(</em><em>float</em><em>, </em><em>float</em><em>)</em>) – The initial and final update strengths for the object. These will affect how
heavily the algorithm affects the object images with each iteration. The first iteration will use
the initial strength, with values being interpolated each iteration until the last iteration uses the final
strength.</p></li>
<li><p><strong>probe_update</strong> (<em>(</em><em>float</em><em>, </em><em>float</em><em>)</em>) – The initial and final update strengths for the probe. These should typically be smaller
than the object update strength because the entire probe gets updated with each step.</p></li>
<li><p><strong>animate</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, show an animation of the reconstruction progress at each iteration. This will only
appear after all reconstruction cycles have completed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="camera.html" class="btn btn-neutral float-right" title="Camera interfacing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="api.html" class="btn btn-neutral float-left" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Nick Porter.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>